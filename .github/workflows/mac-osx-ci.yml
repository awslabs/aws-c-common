name: CI

on: [push]

jobs:
  OSX_CI:

    runs-on: macOS-10.14

    steps:
    - name: Checkout Source
      uses: actions/checkout@v1
    
    - name: Cache LLVM
      id: cache-llvm
      uses: actions/cache@v1
      with:
        key: ${{ runner.OS }}-llvm
    
    - name: Install Dependencies
      if: steps.cache-llvm.outputs.cache-hit != 'true'
      run: |
        brew install llvm
        export PATH=$(brew --prefix llvm)/bin:$PATH
    
    - name: Build and test
      run: |
        python3 ./codebuild/builder.py build macos-default-default-macos-x64
